#!/usr/bin/env node
(async () => {
  // imports
  const { utils } = require('ethers')
  const { wallet, provider, devnetMiner } = require('../chainlink.config')

  // ensure correct CLI ussage
  if (process.argv.length > 3) {
    console.error('Usage: ./fund_dev_wallet (optional address)')
    process.exit(1)
  }

  // setup from wallet and to address
  const recipient = process.argv[2] || wallet.address // default
  const devnetMinerWallet = provider.getSigner(devnetMiner)

  // send transaction
  const tx = {
    to: recipient,
    value: utils.bigNumberify(10).pow(21) // 10 ** 21
  }

  try {
    // send tx
    const txHash = (await devnetMinerWallet.sendTransaction(tx)).hash
    // wait for tx to be mined
    await provider.waitForTransaction(txHash)
    // get tx receipt
    const receipt = await provider.getTransactionReceipt(txHash)
    console.log(receipt)
  } catch (error) {
    console.log(error)
  }
})()
